(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[533],{360:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});var n=s(7876),r=s(7328),a=s.n(r),c=s(8230),o=s.n(c),i=s(9099);function l(e){let{children:t}=e,s=(0,i.useRouter)();return(0,n.jsxs)("div",{className:"min-h-screen flex flex-col bg-gray-100",children:[(0,n.jsxs)(a(),{children:[(0,n.jsx)("title",{children:"簡易会計システム"}),(0,n.jsx)("meta",{name:"description",content:"簡易会計・確定申告支援システム"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,n.jsx)("header",{className:"bg-white shadow",children:(0,n.jsx)("div",{className:"container mx-auto p-4",children:(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)(o(),{href:"/",className:"text-2xl font-bold",children:"簡易会計システム"}),(0,n.jsx)("nav",{className:"hidden md:block",children:(0,n.jsx)("ul",{className:"flex space-x-6",children:[{href:"/",label:"ホーム"},{href:"/transactions",label:"仕訳入力"},{href:"/documents",label:"帳票作成"},{href:"/reports",label:"財務レポート"},{href:"/data-management",label:"データ管理"},{href:"/settings",label:"設定"}].map(e=>(0,n.jsx)("li",{children:(0,n.jsx)(o(),{href:e.href,className:"".concat(s.pathname===e.href?"text-blue-500 font-medium":"text-gray-600 hover:text-blue-500"),children:e.label})},e.href))})}),(0,n.jsx)("button",{className:"md:hidden",children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"w-6 h-6",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})})}),(0,n.jsx)("main",{className:"flex-grow py-6",children:t}),(0,n.jsx)("footer",{className:"bg-white shadow-inner mt-auto",children:(0,n.jsx)("div",{className:"container mx-auto p-4 text-center text-gray-600",children:(0,n.jsx)("p",{children:"\xa9 2025 簡易会計システム"})})})]})}},5019:(e,t,s)=>{"use strict";let n,r;s.d(t,{q:()=>w});let a=(e,t)=>t.some(t=>e instanceof t),c=new WeakMap,o=new WeakMap,i=new WeakMap,l={get(e,t,s){if(e instanceof IDBTransaction){if("done"===t)return c.get(e);if("store"===t)return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return d(e[t])},set:(e,t,s)=>(e[t]=s,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function d(e){if(e instanceof IDBRequest)return function(e){let t=new Promise((t,s)=>{let n=()=>{e.removeEventListener("success",r),e.removeEventListener("error",a)},r=()=>{t(d(e.result)),n()},a=()=>{s(e.error),n()};e.addEventListener("success",r),e.addEventListener("error",a)});return i.set(t,e),t}(e);if(o.has(e))return o.get(e);let t=function(e){if("function"==typeof e)return(r||(r=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(m(this),t),d(this.request)}:function(...t){return d(e.apply(m(this),t))};return(e instanceof IDBTransaction&&function(e){if(c.has(e))return;let t=new Promise((t,s)=>{let n=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",a),e.removeEventListener("abort",a)},r=()=>{t(),n()},a=()=>{s(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",r),e.addEventListener("error",a),e.addEventListener("abort",a)});c.set(e,t)}(e),a(e,n||(n=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(e,l):e}(e);return t!==e&&(o.set(e,t),i.set(t,e)),t}let m=e=>i.get(e),h=["get","getKey","getAll","getAllKeys","count"],u=["put","add","delete","clear"],x=new Map;function p(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(x.get(t))return x.get(t);let s=t.replace(/FromIndex$/,""),n=t!==s,r=u.includes(s);if(!(s in(n?IDBIndex:IDBObjectStore).prototype)||!(r||h.includes(s)))return;let a=async function(e,...t){let a=this.transaction(e,r?"readwrite":"readonly"),c=a.store;return n&&(c=c.index(t.shift())),(await Promise.all([c[s](...t),r&&a.done]))[0]};return x.set(t,a),a}l=(e=>({...e,get:(t,s,n)=>p(t,s)||e.get(t,s,n),has:(t,s)=>!!p(t,s)||e.has(t,s)}))(l);let b=["continue","continuePrimaryKey","advance"],g={},j=new WeakMap,f=new WeakMap,N={get(e,t){if(!b.includes(t))return e[t];let s=g[t];return s||(s=g[t]=function(...e){j.set(this,f.get(this)[t](...e))}),s}};async function*v(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;let s=new Proxy(t,N);for(f.set(s,t),i.set(s,m(t));t;)yield s,t=await (j.get(s)||t.continue()),j.delete(s)}function y(e,t){return t===Symbol.asyncIterator&&a(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&a(e,[IDBIndex,IDBObjectStore])}async function w(){return function(e,t,{blocked:s,upgrade:n,blocking:r,terminated:a}={}){let c=indexedDB.open(e,1),o=d(c);return n&&c.addEventListener("upgradeneeded",e=>{n(d(c.result),e.oldVersion,e.newVersion,d(c.transaction),e)}),s&&c.addEventListener("blocked",e=>s(e.oldVersion,e.newVersion,e)),o.then(e=>{a&&e.addEventListener("close",()=>a()),r&&e.addEventListener("versionchange",e=>r(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}("AccountingAppDB",0,{upgrade(e){if(!e.objectStoreNames.contains("transactions")){let t=e.createObjectStore("transactions",{keyPath:"id"});t.createIndex("date","date"),t.createIndex("debitAccount","debitAccount"),t.createIndex("creditAccount","creditAccount")}if(!e.objectStoreNames.contains("documents")){let t=e.createObjectStore("documents",{keyPath:"id"});t.createIndex("type","type"),t.createIndex("date","date")}e.objectStoreNames.contains("settings")||e.createObjectStore("settings",{keyPath:"id"})}})}l=(e=>({...e,get:(t,s,n)=>y(t,s)?v:e.get(t,s,n),has:(t,s)=>y(t,s)||e.has(t,s)}))(l)},6502:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/reports/income-statement",function(){return s(8474)}])},8474:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s(7876),r=s(4232),a=s(360),c=s(5019),o=s(8230),i=s.n(o);function l(){let[e,t]=(0,r.useState)({startDate:new Date(new Date().getFullYear(),0,1).toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0]}),[s,o]=(0,r.useState)(null),[l,d]=(0,r.useState)(!1),[m,h]=(0,r.useState)(null);(0,r.useEffect)(()=>{x()},[]);let u=s=>{let{name:n,value:r}=s.target;t({...e,[n]:r})},x=async()=>{d(!0),h(null);try{let t=new Date(e.startDate),s=new Date(e.endDate);if(s.setHours(23,59,59,999),t>s){h("開始日は終了日より前の日付を選択してください。"),d(!1);return}let n=(await (0,c.q)()).transaction("transactions","readonly").objectStore("transactions"),r=(await n.getAll()).filter(e=>{let n=new Date(e.date);return n>=t&&n<=s}),a=["売上","受取利息","その他収益"],i=["仕入","旅費交通費","通信費","消耗品費","水道光熱費","家賃","雑費","減価償却費"],l=["受取利息","その他収益"],m=["支払利息","その他費用"],u={period:{startDate:e.startDate,endDate:e.endDate},revenue:{category:"収益",accounts:a,amount:0,items:[]},expenses:{category:"費用",accounts:i,amount:0,items:[]},operatingIncome:0,otherIncome:{category:"その他収益",accounts:l,amount:0,items:[]},otherExpenses:{category:"その他費用",accounts:m,amount:0,items:[]},netIncome:0},x={};[...a,...i,...l,...m].forEach(e=>{x[e]=0}),r.forEach(e=>{a.includes(e.creditAccount)?x[e.creditAccount]+=e.amount:a.includes(e.debitAccount)&&(x[e.debitAccount]+=e.amount),i.includes(e.debitAccount)?x[e.debitAccount]+=e.amount:i.includes(e.creditAccount)&&(x[e.creditAccount]+=e.amount),l.includes(e.creditAccount)?x[e.creditAccount]+=e.amount:l.includes(e.debitAccount)&&(x[e.debitAccount]+=e.amount),m.includes(e.debitAccount)?x[e.debitAccount]+=e.amount:m.includes(e.creditAccount)&&(x[e.creditAccount]+=e.amount)}),a.forEach(e=>{x[e]>0&&(u.revenue.items.push({account:e,amount:x[e]}),u.revenue.amount+=x[e])}),i.forEach(e=>{x[e]>0&&(u.expenses.items.push({account:e,amount:x[e]}),u.expenses.amount+=x[e])}),l.forEach(e=>{x[e]>0&&(u.otherIncome.items.push({account:e,amount:x[e]}),u.otherIncome.amount+=x[e])}),m.forEach(e=>{x[e]>0&&(u.otherExpenses.items.push({account:e,amount:x[e]}),u.otherExpenses.amount+=x[e])}),u.operatingIncome=u.revenue.amount-u.expenses.amount,u.netIncome=u.operatingIncome+u.otherIncome.amount-u.otherExpenses.amount,o(u)}catch(e){console.error("損益計算書の生成に失敗しました:",e),h("損益計算書の生成中にエラーが発生しました。")}finally{d(!1)}};return(0,n.jsx)(a.A,{children:(0,n.jsxs)("div",{className:"container mx-auto p-4",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"損益計算書"}),(0,n.jsx)(i(),{href:"/reports",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",children:"レポート一覧に戻る"})]}),(0,n.jsxs)("div",{className:"bg-white p-4 rounded shadow mb-6",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"期間指定"}),(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault(),x()},className:"flex flex-wrap gap-4 items-end",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block mb-2 font-medium",children:"開始日"}),(0,n.jsx)("input",{type:"date",name:"startDate",value:e.startDate,onChange:u,className:"p-2 border rounded",required:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block mb-2 font-medium",children:"終了日"}),(0,n.jsx)("input",{type:"date",name:"endDate",value:e.endDate,onChange:u,className:"p-2 border rounded",required:!0})]}),(0,n.jsx)("button",{type:"submit",disabled:l,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:bg-gray-400",children:l?"計算中...":"損益計算書を表示"})]}),m&&(0,n.jsx)("p",{className:"text-red-500 mt-2",children:m})]}),s&&(0,n.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,n.jsxs)("h2",{className:"text-xl font-semibold",children:["損益計算書: ",new Date(s.period.startDate).toLocaleDateString()," 〜 ",new Date(s.period.endDate).toLocaleDateString()]}),(0,n.jsx)("button",{onClick:()=>window.print(),className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",children:"印刷"})]}),(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsx)("table",{className:"min-w-full border",children:(0,n.jsxs)("tbody",{children:[(0,n.jsxs)("tr",{className:"bg-gray-100",children:[(0,n.jsx)("th",{colSpan:2,className:"p-3 text-left border",children:s.revenue.category}),(0,n.jsx)("th",{className:"p-3 text-right border",children:"金額"})]}),s.revenue.items.map((e,t)=>(0,n.jsxs)("tr",{className:"border",children:[(0,n.jsx)("td",{className:"p-3 border",width:"10%"}),(0,n.jsx)("td",{className:"p-3 border",children:e.account}),(0,n.jsxs)("td",{className:"p-3 text-right border",children:[e.amount.toLocaleString(),"円"]})]},"revenue-".concat(t))),(0,n.jsxs)("tr",{className:"font-bold",children:[(0,n.jsx)("td",{colSpan:2,className:"p-3 text-right border",children:"収益合計"}),(0,n.jsxs)("td",{className:"p-3 text-right border",children:[s.revenue.amount.toLocaleString(),"円"]})]}),(0,n.jsxs)("tr",{className:"bg-gray-100",children:[(0,n.jsx)("th",{colSpan:2,className:"p-3 text-left border",children:s.expenses.category}),(0,n.jsx)("th",{className:"p-3 text-right border",children:"金額"})]}),s.expenses.items.map((e,t)=>(0,n.jsxs)("tr",{className:"border",children:[(0,n.jsx)("td",{className:"p-3 border",width:"10%"}),(0,n.jsx)("td",{className:"p-3 border",children:e.account}),(0,n.jsxs)("td",{className:"p-3 text-right border",children:[e.amount.toLocaleString(),"円"]})]},"expense-".concat(t))),(0,n.jsxs)("tr",{className:"font-bold",children:[(0,n.jsx)("td",{colSpan:2,className:"p-3 text-right border",children:"費用合計"}),(0,n.jsxs)("td",{className:"p-3 text-right border",children:[s.expenses.amount.toLocaleString(),"円"]})]}),(0,n.jsxs)("tr",{className:"font-bold bg-blue-50",children:[(0,n.jsx)("td",{colSpan:2,className:"p-3 text-right border",children:"営業利益"}),(0,n.jsxs)("td",{className:"p-3 text-right border",children:[s.operatingIncome.toLocaleString(),"円"]})]}),s.otherIncome.items.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("tr",{className:"bg-gray-100",children:[(0,n.jsx)("th",{colSpan:2,className:"p-3 text-left border",children:s.otherIncome.category}),(0,n.jsx)("th",{className:"p-3 text-right border",children:"金額"})]}),s.otherIncome.items.map((e,t)=>(0,n.jsxs)("tr",{className:"border",children:[(0,n.jsx)("td",{className:"p-3 border",width:"10%"}),(0,n.jsx)("td",{className:"p-3 border",children:e.account}),(0,n.jsxs)("td",{className:"p-3 text-right border",children:[e.amount.toLocaleString(),"円"]})]},"otherIncome-".concat(t))),(0,n.jsxs)("tr",{className:"font-bold",children:[(0,n.jsx)("td",{colSpan:2,className:"p-3 text-right border",children:"その他収益合計"}),(0,n.jsxs)("td",{className:"p-3 text-right border",children:[s.otherIncome.amount.toLocaleString(),"円"]})]})]}),s.otherExpenses.items.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("tr",{className:"bg-gray-100",children:[(0,n.jsx)("th",{colSpan:2,className:"p-3 text-left border",children:s.otherExpenses.category}),(0,n.jsx)("th",{className:"p-3 text-right border",children:"金額"})]}),s.otherExpenses.items.map((e,t)=>(0,n.jsxs)("tr",{className:"border",children:[(0,n.jsx)("td",{className:"p-3 border",width:"10%"}),(0,n.jsx)("td",{className:"p-3 border",children:e.account}),(0,n.jsxs)("td",{className:"p-3 text-right border",children:[e.amount.toLocaleString(),"円"]})]},"otherExpense-".concat(t))),(0,n.jsxs)("tr",{className:"font-bold",children:[(0,n.jsx)("td",{colSpan:2,className:"p-3 text-right border",children:"その他費用合計"}),(0,n.jsxs)("td",{className:"p-3 text-right border",children:[s.otherExpenses.amount.toLocaleString(),"円"]})]})]}),(0,n.jsxs)("tr",{className:"font-bold text-lg bg-green-50",children:[(0,n.jsx)("td",{colSpan:2,className:"p-3 text-right border",children:"当期純利益"}),(0,n.jsx)("td",{className:"p-3 text-right border",children:(0,n.jsxs)("span",{className:s.netIncome>=0?"text-green-600":"text-red-600",children:[s.netIncome.toLocaleString(),"円"]})})]})]})})}),(0,n.jsxs)("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,n.jsxs)("div",{className:"bg-gray-50 p-4 rounded shadow",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"収益構成"}),(0,n.jsx)("div",{className:"space-y-2",children:s.revenue.items.map((e,t)=>(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,n.jsx)("span",{children:e.account}),(0,n.jsxs)("span",{children:[Math.round(e.amount/s.revenue.amount*100),"%"]})]}),(0,n.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,n.jsx)("div",{className:"bg-green-500 h-2.5 rounded-full",style:{width:"".concat(Math.round(e.amount/s.revenue.amount*100),"%")}})})]},"revenue-bar-".concat(t)))})]}),(0,n.jsxs)("div",{className:"bg-gray-50 p-4 rounded shadow",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"費用構成"}),(0,n.jsx)("div",{className:"space-y-2",children:s.expenses.items.map((e,t)=>(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,n.jsx)("span",{children:e.account}),(0,n.jsxs)("span",{children:[Math.round(e.amount/s.expenses.amount*100),"%"]})]}),(0,n.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,n.jsx)("div",{className:"bg-red-500 h-2.5 rounded-full",style:{width:"".concat(Math.round(e.amount/s.expenses.amount*100),"%")}})})]},"expense-bar-".concat(t)))})]})]})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[8,636,593,792],()=>t(6502)),_N_E=e.O()}]);