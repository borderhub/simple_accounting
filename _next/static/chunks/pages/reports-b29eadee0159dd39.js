(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[769],{360:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var s=n(7876),r=n(7328),a=n.n(r),c=n(8230),o=n.n(c),l=n(9099);function i(e){let{children:t}=e,n=(0,l.useRouter)();return(0,s.jsxs)("div",{className:"min-h-screen flex flex-col bg-gray-100",children:[(0,s.jsxs)(a(),{children:[(0,s.jsx)("title",{children:"簡易会計システム"}),(0,s.jsx)("meta",{name:"description",content:"簡易会計・確定申告支援システム"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,s.jsx)("header",{className:"bg-white shadow",children:(0,s.jsx)("div",{className:"container mx-auto p-4",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)(o(),{href:"/",className:"text-2xl font-bold",children:"簡易会計システム"}),(0,s.jsx)("nav",{className:"hidden md:block",children:(0,s.jsx)("ul",{className:"flex space-x-6",children:[{href:"/",label:"ホーム"},{href:"/transactions",label:"仕訳入力"},{href:"/documents",label:"帳票作成"},{href:"/reports",label:"財務レポート"},{href:"/data-management",label:"データ管理"},{href:"/settings",label:"設定"}].map(e=>(0,s.jsx)("li",{children:(0,s.jsx)(o(),{href:e.href,className:"".concat(n.pathname===e.href?"text-blue-500 font-medium":"text-gray-600 hover:text-blue-500"),children:e.label})},e.href))})}),(0,s.jsx)("button",{className:"md:hidden",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"w-6 h-6",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})})}),(0,s.jsx)("main",{className:"flex-grow py-6",children:t}),(0,s.jsx)("footer",{className:"bg-white shadow-inner mt-auto",children:(0,s.jsx)("div",{className:"container mx-auto p-4 text-center text-gray-600",children:(0,s.jsx)("p",{children:"\xa9 2025 簡易会計システム"})})})]})}},1433:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/reports",function(){return n(3693)}])},3693:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});var s=n(7876),r=n(4232),a=n(360),c=n(8230),o=n.n(c),l=n(5019);function i(){let[e,t]=(0,r.useState)({startDate:new Date().toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0],reportType:"all"}),[n,c]=(0,r.useState)([]),[i,d]=(0,r.useState)({totalTransactions:0,totalIncome:0,totalExpense:0,netAmount:0}),[u,h]=(0,r.useState)(!1),[m,x]=(0,r.useState)(!1),p=n=>{let{name:s,value:r}=n.target;t({...e,[s]:r})},b=async t=>{t.preventDefault(),h(!0),x(!1);try{let t=new Date(e.startDate),n=new Date(e.endDate);if(n.setHours(23,59,59,999),t>n){alert("開始日は終了日より前の日付を選択してください。"),h(!1);return}let s=(await (0,l.q)()).transaction("transactions","readonly").objectStore("transactions"),r=(await s.getAll()).filter(e=>{let s=new Date(e.date);return s>=t&&s<=n});"income"===e.reportType?r=r.filter(e=>"売上"===e.debitAccount||"売上"===e.creditAccount):"expense"===e.reportType?r=r.filter(e=>"仕入"===e.debitAccount||"旅費交通費"===e.debitAccount||"通信費"===e.debitAccount||"消耗品費"===e.debitAccount||"水道光熱費"===e.debitAccount||"家賃"===e.debitAccount||"雑費"===e.debitAccount):"tax"===e.reportType&&(r=r.filter(e=>{var t;return e.description.includes("税")||(null===(t=e.memo)||void 0===t?void 0:t.includes("税"))}));let a={totalTransactions:r.length,totalIncome:0,totalExpense:0,netAmount:0},o=["仕入","旅費交通費","通信費","消耗品費","水道光熱費","家賃","雑費"];r.forEach(e=>{("売上"===e.debitAccount||"売上"===e.creditAccount)&&(a.totalIncome+=e.amount),(o.includes(e.debitAccount)||o.includes(e.creditAccount))&&(a.totalExpense+=e.amount)}),a.netAmount=a.totalIncome-a.totalExpense,c(r),d(a),x(!0)}catch(e){console.error("レポートデータの取得に失敗しました:",e),alert("レポートの生成中にエラーが発生しました。")}finally{h(!1)}};return(0,s.jsx)(a.A,{children:(0,s.jsxs)("div",{className:"container mx-auto p-4",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"財務レポート"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"資産表"}),(0,s.jsx)("p",{className:"mb-4",children:"現在の資産・負債状況を確認できます"}),(0,s.jsx)(o(),{href:"/reports/balance-sheet",className:"inline-block bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:"資産表を表示"})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"損益計算書"}),(0,s.jsx)("p",{className:"mb-4",children:"特定期間の収益・費用を確認できます"}),(0,s.jsx)(o(),{href:"/reports/income-statement",className:"inline-block bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600",children:"損益計算書を表示"})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"確定申告"}),(0,s.jsx)("p",{className:"mb-4",children:"確定申告に必要な情報を確認できます"}),(0,s.jsx)(o(),{href:"/reports/tax-report",className:"inline-block bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600",children:"確定申告データを表示"})]})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow mb-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"期間指定レポート"}),(0,s.jsx)("p",{className:"mb-4",children:"特定期間のデータを集計したレポートを作成します"}),(0,s.jsxs)("form",{className:"mb-4",onSubmit:b,children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block mb-2 font-medium",children:"開始日"}),(0,s.jsx)("input",{type:"date",name:"startDate",value:e.startDate,onChange:p,className:"w-full p-2 border rounded",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block mb-2 font-medium",children:"終了日"}),(0,s.jsx)("input",{type:"date",name:"endDate",value:e.endDate,onChange:p,className:"w-full p-2 border rounded",required:!0})]})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block mb-2 font-medium",children:"レポートの種類"}),(0,s.jsxs)("select",{name:"reportType",value:e.reportType,onChange:p,className:"w-full p-2 border rounded",required:!0,children:[(0,s.jsx)("option",{value:"all",children:"全取引履歴"}),(0,s.jsx)("option",{value:"income",children:"収益レポート"}),(0,s.jsx)("option",{value:"expense",children:"経費レポート"}),(0,s.jsx)("option",{value:"tax",children:"税金レポート"})]})]}),(0,s.jsx)("button",{type:"submit",disabled:u,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:bg-gray-400",children:u?"レポート生成中...":"レポート作成"})]})]}),m&&(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["レポート結果: ",e.startDate," 〜 ",e.endDate,"all"!==e.reportType&&" (".concat("income"===e.reportType?"収益":"expense"===e.reportType?"経費":"税金",")")]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,s.jsxs)("div",{className:"bg-blue-50 p-3 rounded",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"取引件数"}),(0,s.jsxs)("p",{className:"text-xl font-bold",children:[i.totalTransactions,"件"]})]}),(0,s.jsxs)("div",{className:"bg-green-50 p-3 rounded",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"総収入"}),(0,s.jsxs)("p",{className:"text-xl font-bold text-green-600",children:[i.totalIncome.toLocaleString(),"円"]})]}),(0,s.jsxs)("div",{className:"bg-red-50 p-3 rounded",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"総支出"}),(0,s.jsxs)("p",{className:"text-xl font-bold text-red-600",children:[i.totalExpense.toLocaleString(),"円"]})]}),(0,s.jsxs)("div",{className:"bg-purple-50 p-3 rounded",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"収支"}),(0,s.jsxs)("p",{className:"text-xl font-bold ".concat(i.netAmount>=0?"text-green-600":"text-red-600"),children:[i.netAmount.toLocaleString(),"円"]})]})]}),n.length>0?(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"bg-gray-100",children:[(0,s.jsx)("th",{className:"p-2 text-left",children:"日付"}),(0,s.jsx)("th",{className:"p-2 text-left",children:"摘要"}),(0,s.jsx)("th",{className:"p-2 text-right",children:"金額"}),(0,s.jsx)("th",{className:"p-2 text-left",children:"借方科目"}),(0,s.jsx)("th",{className:"p-2 text-left",children:"貸方科目"})]})}),(0,s.jsx)("tbody",{children:n.map(e=>(0,s.jsxs)("tr",{className:"border-b",children:[(0,s.jsx)("td",{className:"p-2",children:new Date(e.date).toLocaleDateString()}),(0,s.jsx)("td",{className:"p-2",children:e.description}),(0,s.jsxs)("td",{className:"p-2 text-right",children:[e.amount.toLocaleString(),"円"]}),(0,s.jsx)("td",{className:"p-2",children:e.debitAccount}),(0,s.jsx)("td",{className:"p-2",children:e.creditAccount})]},e.id))})]})}):(0,s.jsx)("p",{className:"text-center py-4",children:"該当期間のデータはありません。"}),(0,s.jsxs)("div",{className:"mt-4 flex justify-end",children:[(0,s.jsx)("button",{onClick:()=>window.print(),className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 mr-2",children:"印刷"}),(0,s.jsx)("button",{onClick:()=>{let t=n.map(e=>[new Date(e.date).toLocaleDateString(),e.description,e.amount,e.debitAccount,e.creditAccount]),s="日付,摘要,金額,借方科目,貸方科目\n";t.forEach(e=>{s+=e.join(",")+"\n"});let r=new Blob([s],{type:"text/csv"}),a=window.URL.createObjectURL(r),c=document.createElement("a");c.setAttribute("hidden",""),c.setAttribute("href",a),c.setAttribute("download","report-".concat(e.startDate,"-to-").concat(e.endDate,".csv")),document.body.appendChild(c),c.click(),document.body.removeChild(c)},className:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600",children:"CSVダウンロード"})]})]})]})})}},5019:(e,t,n)=>{"use strict";let s,r;n.d(t,{q:()=>y});let a=(e,t)=>t.some(t=>e instanceof t),c=new WeakMap,o=new WeakMap,l=new WeakMap,i={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return c.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return d(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function d(e){if(e instanceof IDBRequest)return function(e){let t=new Promise((t,n)=>{let s=()=>{e.removeEventListener("success",r),e.removeEventListener("error",a)},r=()=>{t(d(e.result)),s()},a=()=>{n(e.error),s()};e.addEventListener("success",r),e.addEventListener("error",a)});return l.set(t,e),t}(e);if(o.has(e))return o.get(e);let t=function(e){if("function"==typeof e)return(r||(r=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(u(this),t),d(this.request)}:function(...t){return d(e.apply(u(this),t))};return(e instanceof IDBTransaction&&function(e){if(c.has(e))return;let t=new Promise((t,n)=>{let s=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",a),e.removeEventListener("abort",a)},r=()=>{t(),s()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",r),e.addEventListener("error",a),e.addEventListener("abort",a)});c.set(e,t)}(e),a(e,s||(s=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(e,i):e}(e);return t!==e&&(o.set(e,t),l.set(t,e)),t}let u=e=>l.get(e),h=["get","getKey","getAll","getAllKeys","count"],m=["put","add","delete","clear"],x=new Map;function p(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(x.get(t))return x.get(t);let n=t.replace(/FromIndex$/,""),s=t!==n,r=m.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(r||h.includes(n)))return;let a=async function(e,...t){let a=this.transaction(e,r?"readwrite":"readonly"),c=a.store;return s&&(c=c.index(t.shift())),(await Promise.all([c[n](...t),r&&a.done]))[0]};return x.set(t,a),a}i=(e=>({...e,get:(t,n,s)=>p(t,n)||e.get(t,n,s),has:(t,n)=>!!p(t,n)||e.has(t,n)}))(i);let b=["continue","continuePrimaryKey","advance"],j={},f=new WeakMap,g=new WeakMap,N={get(e,t){if(!b.includes(t))return e[t];let n=j[t];return n||(n=j[t]=function(...e){f.set(this,g.get(this)[t](...e))}),n}};async function*v(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;let n=new Proxy(t,N);for(g.set(n,t),l.set(n,u(t));t;)yield n,t=await (f.get(n)||t.continue()),f.delete(n)}function w(e,t){return t===Symbol.asyncIterator&&a(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&a(e,[IDBIndex,IDBObjectStore])}async function y(){return function(e,t,{blocked:n,upgrade:s,blocking:r,terminated:a}={}){let c=indexedDB.open(e,1),o=d(c);return s&&c.addEventListener("upgradeneeded",e=>{s(d(c.result),e.oldVersion,e.newVersion,d(c.transaction),e)}),n&&c.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),o.then(e=>{a&&e.addEventListener("close",()=>a()),r&&e.addEventListener("versionchange",e=>r(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}("AccountingAppDB",0,{upgrade(e){if(!e.objectStoreNames.contains("transactions")){let t=e.createObjectStore("transactions",{keyPath:"id"});t.createIndex("date","date"),t.createIndex("debitAccount","debitAccount"),t.createIndex("creditAccount","creditAccount")}if(!e.objectStoreNames.contains("documents")){let t=e.createObjectStore("documents",{keyPath:"id"});t.createIndex("type","type"),t.createIndex("date","date")}e.objectStoreNames.contains("settings")||e.createObjectStore("settings",{keyPath:"id"})}})}i=(e=>({...e,get:(t,n,s)=>w(t,n)?v:e.get(t,n,s),has:(t,n)=>w(t,n)||e.has(t,n)}))(i)}},e=>{var t=t=>e(e.s=t);e.O(0,[8,636,593,792],()=>t(1433)),_N_E=e.O()}]);